(this["webpackJsonptodo-react-app"]=this["webpackJsonptodo-react-app"]||[]).push([[0],{163:function(e,t,n){},287:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(14),c=n.n(a),s=(n(163),n(35)),o=n(316),i=n(318),u=n(320),l=n(321),d=n(322),j=n(2),p=Object(o.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}})),b=function(e){var t=e.logged,n=e.logout,r=p();return Object(j.jsx)(i.a,{position:"fixed",children:Object(j.jsxs)(u.a,{children:[Object(j.jsx)("div",{className:r.title,children:t&&Object(j.jsx)(s.b,{to:"/",children:Object(j.jsx)(l.a,{variant:"h6",children:"Tasks"})})}),Object(j.jsx)("div",{children:t?Object(j.jsx)(d.a,{color:"inherit",onClick:n,children:"Logout"}):Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(s.b,{to:"/login",children:Object(j.jsx)(d.a,{color:"inherit",children:"Login"})}),Object(j.jsx)(s.b,{to:"/registration",children:Object(j.jsx)(d.a,{color:"inherit",children:"Registration"})})]})})]})})},f=n(15),h=n(7),m=n.n(h),x=n(10),O=n(68),g=n.n(O),v=n(11),k=n(12),w=(g.a.create({baseURL:"https://todo-backend-alpaca.herokuapp.com"}),g.a.create({withCredentials:!0,baseURL:"https://todo-backend-alpaca.herokuapp.com"})),y=function(){function e(){Object(v.a)(this,e)}return Object(k.a)(e,null,[{key:"registration",value:function(){var e=Object(x.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.post("/registration",t);case 2:if(200===(n=e.sent).status){e.next=5;break}throw Error("Failed to get the task list");case 5:return e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"login",value:function(){var e=Object(x.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.post("/login",t);case 2:if(200===(n=e.sent).status){e.next=5;break}throw Error("Failed to get the task list");case 5:return e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"logout",value:function(){var e=Object(x.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.post("/logout");case 2:t=e.sent,console.log(t);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"refreshToken",value:function(){var e=Object(x.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.post("/refresh-token");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}]),e}(),T=function(){var e=function(){var e=[],t="jwtToken",n=function(e){return e&&1e3*JSON.parse(atob(e.split(".")[1])).exp||null},r=function(){var e=Object(x.a)(m.a.mark((function e(){var t,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=localStorage.getItem("jwtToken"),!((a=n(t))&&Date.now()>a)){e.next=6;break}return e.next=4,y.refreshToken();case 4:r=e.sent,c(r.data.jwtToken);case 6:return e.abrupt("return",localStorage.getItem("jwtToken"));case 7:case"end":return e.stop()}var a}),e)})));return function(){return e.apply(this,arguments)}}(),a=function(){return!!localStorage.getItem("jwtToken")},c=function(e){e?localStorage.setItem(t,e):localStorage.removeItem(t),s()},s=function(){var t=a();e.forEach((function(e){return e(t)}))};return{getToken:r,isLoggedIn:a,setToken:c,subscribe:function(t){e.push(t)},unsubscribe:function(t){e=e.filter((function(e){return e!==t}))}}}(),t=g.a.create({baseURL:"https://todo-backend-alpaca.herokuapp.com"});t.interceptors.request.use(function(){var t=Object(x.a)(m.a.mark((function t(n){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0="Bearer ",t.next=3,e.getToken();case 3:return t.t1=t.sent,n.headers.Authorization=t.t0.concat.call(t.t0,t.t1),t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());return{useAuth:function(){var t=Object(r.useState)(e.isLoggedIn()),n=Object(f.a)(t,2),a=n[0],c=n[1],s=Object(r.useCallback)((function(e){c(e)}),[c]);return Object(r.useEffect)((function(){return e.subscribe(s),function(){e.unsubscribe(s)}}),[s]),a},axiosWithToken:t,login:function(t){e.setToken(t)},logout:function(){var t=Object(x.a)(m.a.mark((function t(){return m.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,y.logout();case 2:e.setToken(null);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}}(),C=T.useAuth,S=T.axiosWithToken,E=T.login,F=T.logout,D=n(16),I=n(323),P=n(324),B=n(329),L=n(330),N=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Object(x.a)(m.a.mark((function n(){var r,a=arguments;return m.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.apply(void 0,a);case 3:return n.abrupt("return",n.sent);case 6:n.prev=6,n.t0=n.catch(0),r=n.t0.response.data.message,t&&t(r||n.t0.message),console.log(n.t0.message);case 11:case"end":return n.stop()}}),n,null,[[0,6]])})))},A=n(32),H=n(87),R=function(e){var t=e.login,n=e.setError,a=Object(r.useState)(!1),c=Object(f.a)(a,2),s=c[0],o=c[1],i=A.a().shape({email:A.c().required().email(),password:A.c().required()}),u=N(function(){var e=Object(x.a)(m.a.mark((function e(n){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.login(n);case 2:if((r=e.sent).jwtToken){e.next=5;break}return e.abrupt("return");case 5:o(!0),t(r.jwtToken);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n);return s?Object(j.jsx)(D.a,{to:"/"}):Object(j.jsx)(I.a,{container:!0,alignItems:"center",justifyContent:"center",style:{height:"100vh"},children:Object(j.jsx)(P.a,{maxWidth:"sm",children:Object(j.jsx)(H.a,{initialValues:{email:"",password:"",confirmPassword:""},onSubmit:function(e){u(e)},validationSchema:i,validateOnBlur:!0,children:function(e){var t=e.values,n=e.errors,r=e.touched,a=e.handleChange,c=e.handleBlur,s=e.isValid,o=e.handleSubmit,i=e.dirty,u=e.isSubmitting;return Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)("form",{children:[Object(j.jsxs)(I.a,{container:!0,direction:"column",className:"formContainer",children:[Object(j.jsx)(l.a,{variant:"h4",component:"h4",align:"center",children:"Login"}),Object(j.jsx)(B.a,{name:"email",label:"Login",type:"text",utocomplete:"username email",error:!(!r.email||!n.email),helperText:r.email&&n.email,onChange:a,onBlur:c,value:t.email}),Object(j.jsx)(B.a,{name:"password",label:"Password",type:"text",utocomplete:"password",error:!(!r.password||!n.password),helperText:r.password&&n.password,onChange:a,onBlur:c,value:t.password})]}),Object(j.jsx)(L.a,{mt:3,children:Object(j.jsx)(d.a,{disabled:!i||!s||u,variant:"contained",color:"primary",type:"submit",onClick:o,children:"Login"})})]})})}})})})},q=function(e){var t=e.login,n=e.setError,a=Object(r.useState)(!1),c=Object(f.a)(a,2),s=c[0],o=c[1],i=A.a().shape({email:A.c().required().email(),password:A.c().required(),confirmPassword:A.c().required().oneOf([A.b("password")],"Password mismatch")}),u=N(function(){var e=Object(x.a)(m.a.mark((function e(n){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.registration(n);case 2:if((r=e.sent).jwtToken){e.next=5;break}return e.abrupt("return");case 5:o(!0),t(r.jwtToken);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),n);return s?Object(j.jsx)(D.a,{to:"/"}):Object(j.jsx)(I.a,{container:!0,alignItems:"center",justifyContent:"center",style:{height:"100vh"},children:Object(j.jsx)(P.a,{maxWidth:"sm",children:Object(j.jsx)(H.a,{initialValues:{email:"",password:"",confirmPassword:""},onSubmit:function(e){delete e.confirmPassword,u(e)},validationSchema:i,validateOnBlur:!0,children:function(e){var t=e.values,n=e.errors,r=e.touched,a=e.handleChange,c=e.handleBlur,s=e.isValid,o=e.handleSubmit,i=e.dirty;e.isSubmitting;return Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)("form",{children:[Object(j.jsxs)(I.a,{container:!0,direction:"column",className:"formContainer",children:[Object(j.jsx)(l.a,{variant:"h4",component:"h4",align:"center",children:"Registration"}),Object(j.jsx)(B.a,{name:"email",label:"Login",type:"text",utocomplete:"username email",error:!(!r.email||!n.email),helperText:r.email&&n.email,onChange:a,onBlur:c,value:t.email}),Object(j.jsx)(B.a,{name:"password",label:"Password",type:"text",utocomplete:"password",error:!(!r.password||!n.password),helperText:r.password&&n.password,onChange:a,onBlur:c,value:t.password}),Object(j.jsx)(B.a,{name:"confirmPassword",label:"Confirm password",type:"text",utocomplete:"password",error:!(!r.confirmPassword||!n.confirmPassword),helperText:r.confirmPassword&&n.confirmPassword,onChange:a,onBlur:c,value:t.confirmPassword})]}),Object(j.jsx)(L.a,{mt:3,children:Object(j.jsx)(d.a,{disabled:!i||!s,variant:"contained",color:"primary",type:"submit",onClick:o,children:"Registration"})})]})})}})})})},V=n(30),W=Object(o.a)((function(e){return{error:{display:"block",textAlign:"center",background:e.palette.error.light,borderRadius:"5px",padding:"8px 24px"}}})),U=function(e){var t=e.children,n=e.setError,a=e.time,c=W();return Object(r.useEffect)((function(){setTimeout((function(){n("")}),a)})),Object(j.jsx)(L.a,{p:1,className:"error_panel",children:Object(j.jsx)(l.a,{component:"span",className:c.error,children:t})})},z=n(325),J=Object(o.a)((function(e){return{inputForm:{padding:[e.spacing(1),e.spacing(1)].join(" "),marginTop:e.spacing(2),width:"100%"}}})),M=function(e){var t=e.createTaskFetch,n=J(),a=Object(r.useState)(""),c=Object(f.a)(a,2),s=c[0],o=c[1],i=function(){var e=Object(x.a)(m.a.mark((function e(n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==n.code||!s.trim()){e.next=4;break}return e.next=3,t(s);case 3:o("");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(j.jsx)(j.Fragment,{children:Object(j.jsx)(z.a,{className:n.inputForm,type:"text",placeholder:"i want to ...",value:s,onChange:function(e){o(e.target.value)},onKeyDown:i})})},G=n(327),K=n(145),_=n.n(K),Q=n(146),X=n.n(Q),Y="asc",Z="desc",$=function(e){var t=e.setFilter,n=function(e){return function(){return t((function(t){return Object(V.a)(Object(V.a)({},t),{},{filterType:e})}))}},r=function(e){return function(){return t((function(t){return Object(V.a)(Object(V.a)({},t),{},{sortDirection:e})}))}};return Object(j.jsx)(L.a,{mt:2,children:Object(j.jsxs)(I.a,{container:!0,justifyContent:"space-between",alignItems:"center",children:[Object(j.jsxs)(L.a,{children:[Object(j.jsx)(d.a,{onClick:n(""),children:"All"}),Object(j.jsx)(d.a,{onClick:n("done"),children:"Done"}),Object(j.jsx)(d.a,{onClick:n("undone"),children:"Undone"})]}),Object(j.jsxs)(L.a,{children:[Object(j.jsx)(l.a,{display:"inline",children:"Sort by Date"}),Object(j.jsx)(G.a,{onClick:r(Z),children:Object(j.jsx)(_.a,{})}),Object(j.jsx)(G.a,{onClick:r(Y),children:Object(j.jsx)(X.a,{})})]})]})})},ee=n(328),te=n(147),ne=n.n(te),re=n(148),ae=n.n(re),ce=Object(o.a)((function(e){return{listItem:{borderRadius:"5px",border:"1px solid"+e.palette.grey[400],marginTop:e.spacing(1),transition:"all .4s"},completed:{background:"#eaffe9",borderColor:e.palette.success.main},hiddenInput:{width:"100px"}}})),se=function(e){var t=e.task,n=e.editTaskFetch,a=e.deleteTaskFetch,c=(e.changePosition,e.dragAndDrop),s=ce(),o=Object(r.useState)(!0),i=Object(f.a)(o,2),u=i[0],d=i[1],p=function(){var e=Object(x.a)(m.a.mark((function e(n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.stopPropagation(),a(t.id);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(j.jsx)(ee.a,{className:t.done?[s.listItem,s.completed].join(" "):s.listItem,onClick:function(e){e.stopPropagation(),d(!1)},onDragStart:c.dragStartHandler,onDragLeave:c.dragLeaveHandler,onDragOver:c.dragOverHandler,onDragEnd:c.dragEndHandler,onDrop:c.onDropHandler,draggable:!0,children:Object(j.jsxs)(I.a,{container:!0,justifyContent:"space-between",alignItems:"center",children:[Object(j.jsxs)(L.a,{children:[Object(j.jsx)(G.a,{size:"small",onClick:function(e){e.stopPropagation(),n(t.id,{done:!0})},className:"icon-button",children:Object(j.jsx)(ne.a,{})}),u?Object(j.jsx)(l.a,{component:"span",children:t.name}):Object(j.jsx)(z.a,{autoFocus:!0,onBlur:function(){return d(!0)},onKeyDown:function(e){"Enter"===e.code&&(n(t.id,{name:e.target.value}),d(!0)),"Escape"===e.code&&d(!0)},defaultValue:t.name})]}),Object(j.jsxs)(L.a,{children:[Object(j.jsx)(l.a,{component:"span",children:t.createdAt.substr(0,10)}),Object(j.jsx)(G.a,{size:"small",onClick:p,className:"icon-button",children:Object(j.jsx)(ae.a,{})})]})]})})},oe=n(326),ie=function(e){var t=e.displayedTasks,n=e.editTaskFetch,a=e.deleteTaskFetch,c=e.changePosition,s=Object(r.useState)({}),o=Object(f.a)(s,2),i=o[0],u=o[1],l=function(e){return{dragStartHandler:function(){u(e)},dragLeaveHandler:function(e){e.target.style.transform=""},dragOverHandler:function(e){e.preventDefault(),e.target.style.transform="scale(1.03)"},onDropHandler:function(t){t.preventDefault();var r=i.id,a=e.id;a!==r&&n(i.id,{change_position:{selectedTaskId:r,targetTaskId:a}})}}};return Object(j.jsx)(oe.a,{children:t.length>0&&t.map((function(e){return Object(j.jsx)(se,{task:e,editTaskFetch:n,deleteTaskFetch:a,changePosition:c,dragAndDrop:l(e)},e.id)}))})},ue=n(331),le=function(){function e(){Object(v.a)(this,e)}return Object(k.a)(e,null,[{key:"getAll",value:function(){var e=Object(x.a)(m.a.mark((function e(){var t,n,r,a,c=arguments;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:"",n=c.length>1&&void 0!==c[1]?c[1]:Y,r={order:n},t&&(r.filterBy=t),e.next=6,S.get("/tasks",{params:r});case 6:if(200===(a=e.sent).status){e.next=9;break}throw Error("Failed to get the task list");case 9:return e.abrupt("return",a.data);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"create",value:function(){var e=Object(x.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.post("/task",{name:t,done:!1});case 2:if(200===(n=e.sent).status){e.next=5;break}throw Error("Task not created");case 5:return e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"edit",value:function(){var e=Object(x.a)(m.a.mark((function e(t,n){var r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.patch("/task/".concat(t),n);case 2:if(200===(r=e.sent).status){e.next=5;break}throw Error("Data change error");case 5:return e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(x.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,S.delete("/task/".concat(t));case 2:if(204===(n=e.sent).status){e.next=5;break}throw Error("Data deletion error");case 5:return e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),de=function(e){var t=e.setError,n=Object(r.useState)([]),a=Object(f.a)(n,2),c=a[0],s=a[1],o=Object(r.useState)({sortDirection:Z,filterType:""}),i=Object(f.a)(o,2),u=i[0],d=i[1],p=Object(r.useState)({page:1,limit:5}),b=Object(f.a)(p,2),h=b[0],O=b[1],g=Object(r.useMemo)((function(){return N(Object(x.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.getAll(u.filterType,u.sortDirection);case 2:t=e.sent,s(t);case 4:case"end":return e.stop()}}),e)}))),t)}),[u]),v=N(function(){var e=Object(x.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.create(t);case 2:O((function(e){return Object(V.a)(Object(V.a)({},e),{},{page:1})})),d({sortDirection:Z,filterType:""});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t),k=N(function(){var e=Object(x.a)(m.a.mark((function e(t,n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.edit(t,n);case 2:g();case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),t),w=N(function(){var e=Object(x.a)(m.a.mark((function e(t){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,le.delete(t);case 2:g();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),t);Object(r.useEffect)((function(){g()}),[g]),Object(r.useEffect)((function(){O((function(e){return Object(V.a)(Object(V.a)({},e),{},{page:1})}))}),[u]);var y=Object(r.useMemo)((function(){return c.slice((h.page-1)*h.limit,(h.page-1)*h.limit+h.limit)}),[c,h]);return Object(j.jsx)(I.a,{container:!0,alignItems:"center",justifyContent:"center",className:"gridContainer",style:{height:"100vh"},children:Object(j.jsx)(P.a,{maxWidth:"sm",children:Object(j.jsxs)(I.a,{container:!0,direction:"column",children:[Object(j.jsx)(l.a,{variant:"h4",component:"h1",align:"center",children:"ToDo"}),Object(j.jsx)(M,{setTasks:s,createTaskFetch:v}),Object(j.jsx)($,{setFilter:d}),Object(j.jsx)(ie,{displayedTasks:y,deleteTaskFetch:w,editTaskFetch:k,tasks:c,filter:u}),Object(j.jsx)(ue.a,{count:Math.ceil(c.length/h.limit),onChange:function(e,t){return O((function(e){return Object(V.a)(Object(V.a)({},e),{},{page:t})}))},page:h.page,className:"todo-pagination"})]})})})},je=function(e){var t=e.logged,n=Object(r.useState)(""),a=Object(f.a)(n,2),c=a[0],s=a[1];return Object(j.jsxs)(j.Fragment,{children:[c&&Object(j.jsx)(U,{time:1e4,setError:s,children:c}),Object(j.jsx)(D.d,{children:t?Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(D.b,{path:"/",children:Object(j.jsx)(de,{setError:s})}),Object(j.jsx)(D.a,{to:"/"})]}):Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(D.b,{path:"/login",children:Object(j.jsx)(R,{login:E,setError:s})}),Object(j.jsx)(D.b,{path:"/registration",children:Object(j.jsx)(q,{login:E,setError:s})}),Object(j.jsx)(D.a,{to:"/login"})]})})]})};var pe=function(){var e=C();return Object(j.jsxs)(s.a,{basename:"/todo-list",children:[Object(j.jsx)(b,{logged:e,logout:F}),Object(j.jsx)(je,{logged:e})]})};c.a.render(Object(j.jsx)(pe,{}),document.getElementById("root"))}},[[287,1,2]]]);
//# sourceMappingURL=main.7d64c539.chunk.js.map