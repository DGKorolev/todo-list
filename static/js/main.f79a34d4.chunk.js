(this["webpackJsonptodo-react-app"]=this["webpackJsonptodo-react-app"]||[]).push([[0],{164:function(e,t,n){},288:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(14),c=n.n(a),i=(n(164),n(35)),o=n(16),s=n(317),u=n(319),l=n(321),d=n(322),j=n(323),p=n(2),b=Object(s.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}})),f=function(e){var t=e.logged,n=e.logout,r=b();return Object(p.jsx)(u.a,{position:"fixed",children:Object(p.jsxs)(l.a,{children:[Object(p.jsx)("div",{className:r.title,children:t&&Object(p.jsx)(i.b,{to:"/",children:Object(p.jsx)(d.a,{variant:"h6",children:"Tasks"})})}),Object(p.jsx)("div",{children:t?Object(p.jsx)(j.a,{color:"inherit",onClick:n,children:"Logout"}):Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(i.b,{to:"/login",children:Object(p.jsx)(j.a,{color:"inherit",children:"Login"})}),Object(p.jsx)(i.b,{to:"/registration",children:Object(p.jsx)(j.a,{color:"inherit",children:"Registration"})})]})})]})})},h=n(15),m=n(7),O=n.n(m),x=n(13),g=n(83),v=n.n(g),w=v.a.create({withCredentials:!0,baseURL:Object({NODE_ENV:"production",PUBLIC_URL:"/todo-list",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_ADDRESS}),k=function(){var e=function(){var e=[],t="jwtToken",n=function(e){return e&&1e3*JSON.parse(atob(e.split(".")[1])).exp||null},r=function(){var e=Object(x.a)(O.a.mark((function e(){var t,r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=localStorage.getItem("jwtToken"),!((a=n(t))&&Date.now()>a)){e.next=6;break}return e.next=4,w.post("/refresh-token");case 4:r=e.sent,c(r.data.jwtToken);case 6:return e.abrupt("return",localStorage.getItem("jwtToken"));case 7:case"end":return e.stop()}var a}),e)})));return function(){return e.apply(this,arguments)}}(),a=function(){return!!localStorage.getItem("jwtToken")},c=function(e){e?localStorage.setItem(t,e):localStorage.removeItem(t),i()},i=function(){var t=a();e.forEach((function(e){return e(t)}))};return{getToken:r,isLoggedIn:a,setToken:c,subscribe:function(t){e.push(t)},unsubscribe:function(t){e=e.filter((function(e){return e!==t}))}}}(),t=v.a.create({baseURL:Object({NODE_ENV:"production",PUBLIC_URL:"/todo-list",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).REACT_APP_API_ADDRESS});t.interceptors.request.use(function(){var t=Object(x.a)(O.a.mark((function t(n){return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0="Bearer ",t.next=3,e.getToken();case 3:return t.t1=t.sent,n.headers.Authorization=t.t0.concat.call(t.t0,t.t1),t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());return{useAuth:function(){var t=Object(r.useState)(e.isLoggedIn()),n=Object(h.a)(t,2),a=n[0],c=n[1],i=Object(r.useCallback)((function(e){c(e)}),[c]);return Object(r.useEffect)((function(){return e.subscribe(i),function(){e.unsubscribe(i)}}),[i]),a},axiosWithToken:t,login:function(t){e.setToken(t)},logout:function(){var t=Object(x.a)(O.a.mark((function t(){return O.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,w.post("/logout");case 2:e.setToken(null);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}}(),T=k.useAuth,y=k.axiosWithToken,S=k.login,C=k.logout,_=n(149),E=n(324),D=n(325),P=n(330),F=n(331),A=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Object(x.a)(O.a.mark((function n(){var r=arguments;return O.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.apply(void 0,r);case 3:return n.abrupt("return",n.sent);case 6:n.prev=6,n.t0=n.catch(0),t&&t(n.t0.message),console.log(n.t0.message);case 10:case"end":return n.stop()}}),n,null,[[0,6]])})))},I=n(10),R=n(11),L=function(){function e(){Object(I.a)(this,e)}return Object(R.a)(e,null,[{key:"registration",value:function(){var e=Object(x.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.post("/registration",t);case 2:if(200===(n=e.sent).status){e.next=5;break}throw Error("Failed to get the task list");case 5:return e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"login",value:function(){var e=Object(x.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w.post("/login",t);case 2:if(200===(n=e.sent).status){e.next=5;break}throw Error("Failed to get the task list");case 5:return e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),B=n(32),H=n(87),N=["login"],W=function(e){var t=e.login,n=(Object(_.a)(e,N),Object(r.useState)(!1)),a=Object(h.a)(n,2),c=a[0],i=a[1],s=B.a().shape({email:B.c().required().email(),password:B.c().required()}),u=A(function(){var e=Object(x.a)(O.a.mark((function e(n){var r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.login(n);case 2:if((r=e.sent).jwtToken){e.next=5;break}return e.abrupt("return");case 5:i(!0),t(r.jwtToken);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());return c?Object(p.jsx)(o.a,{to:"/"}):Object(p.jsx)(E.a,{container:!0,alignItems:"center",justifyContent:"center",style:{height:"100vh"},children:Object(p.jsx)(D.a,{maxWidth:"sm",children:Object(p.jsx)(H.a,{initialValues:{email:"",password:"",confirmPassword:""},onSubmit:function(e){u(e)},validationSchema:s,validateOnBlur:!0,children:function(e){var t=e.values,n=e.errors,r=e.touched,a=e.handleChange,c=e.handleBlur,i=e.isValid,o=e.handleSubmit,s=e.dirty,u=e.isSubmitting;return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("form",{children:[Object(p.jsxs)(E.a,{container:!0,direction:"column",className:"formContainer",children:[Object(p.jsx)(d.a,{variant:"h4",component:"h4",align:"center",children:"Login"}),Object(p.jsx)(P.a,{name:"email",label:"Login",type:"text",utocomplete:"username email",error:!(!r.email||!n.email),helperText:r.email&&n.email,onChange:a,onBlur:c,value:t.email}),Object(p.jsx)(P.a,{name:"password",label:"Password",type:"text",utocomplete:"password",error:!(!r.password||!n.password),helperText:r.password&&n.password,onChange:a,onBlur:c,value:t.password})]}),Object(p.jsx)(F.a,{mt:3,children:Object(p.jsx)(j.a,{disabled:!s||!i||u,variant:"contained",color:"primary",type:"submit",onClick:o,children:"Login"})})]})})}})})})},K=function(e){var t=e.login,n=Object(r.useState)(!1),a=Object(h.a)(n,2),c=a[0],i=a[1],s=B.a().shape({email:B.c().required().email(),password:B.c().required(),confirmPassword:B.c().required().oneOf([B.b("password")],"Password mismatch")}),u=A(function(){var e=Object(x.a)(O.a.mark((function e(n){var r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.registration(n);case 2:if((r=e.sent).jwtToken){e.next=5;break}return e.abrupt("return");case 5:i(!0),t(r.jwtToken);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());return c?Object(p.jsx)(o.a,{to:"/"}):Object(p.jsx)(E.a,{container:!0,alignItems:"center",justifyContent:"center",style:{height:"100vh"},children:Object(p.jsx)(D.a,{maxWidth:"sm",children:Object(p.jsx)(H.a,{initialValues:{email:"",password:"",confirmPassword:""},onSubmit:function(e){delete e.confirmPassword,u(e)},validationSchema:s,validateOnBlur:!0,children:function(e){var t=e.values,n=e.errors,r=e.touched,a=e.handleChange,c=e.handleBlur,i=e.isValid,o=e.handleSubmit,s=e.dirty,u=e.isSubmitting;return Object(p.jsx)(p.Fragment,{children:Object(p.jsxs)("form",{children:[Object(p.jsxs)(E.a,{container:!0,direction:"column",className:"formContainer",children:[Object(p.jsx)(d.a,{variant:"h4",component:"h4",align:"center",children:"Registration"}),Object(p.jsx)(P.a,{name:"email",label:"Login",type:"text",utocomplete:"username email",error:!(!r.email||!n.email),helperText:r.email&&n.email,onChange:a,onBlur:c,value:t.email}),Object(p.jsx)(P.a,{name:"password",label:"Password",type:"text",utocomplete:"password",error:!(!r.password||!n.password),helperText:r.password&&n.password,onChange:a,onBlur:c,value:t.password}),Object(p.jsx)(P.a,{name:"confirmPassword",label:"Confirm password",type:"text",utocomplete:"password",error:!(!r.confirmPassword||!n.confirmPassword),helperText:r.confirmPassword&&n.confirmPassword,onChange:a,onBlur:c,value:t.confirmPassword})]}),Object(p.jsx)(F.a,{mt:3,children:Object(p.jsx)(j.a,{disabled:!s||!i||u,variant:"contained",color:"primary",type:"submit",onClick:o,children:"Registration"})})]})})}})})})},U=n(30),V=Object(s.a)((function(e){return{error:{display:"block",textAlign:"center",background:e.palette.error.light,borderRadius:"5px",padding:"8px 24px"}}})),q=function(e){var t=e.children,n=e.setError,a=e.time,c=V();return Object(r.useEffect)((function(){setTimeout((function(){n("")}),a)})),Object(p.jsx)(F.a,{p:1,children:Object(p.jsx)(d.a,{component:"span",className:c.error,children:t})})},M=n(326),z=Object(s.a)((function(e){return{inputForm:{padding:[e.spacing(1),e.spacing(1)].join(" "),marginTop:e.spacing(2),width:"100%"}}})),J=function(e){var t=e.createTaskFetch,n=z(),a=Object(r.useState)(""),c=Object(h.a)(a,2),i=c[0],o=c[1],s=function(){var e=Object(x.a)(O.a.mark((function e(n){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==n.code||!i.trim()){e.next=4;break}return e.next=3,t(i);case 3:o("");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsx)(p.Fragment,{children:Object(p.jsx)(M.a,{className:n.inputForm,type:"text",placeholder:"i want to ...",value:i,onChange:function(e){o(e.target.value)},onKeyDown:s})})},G=n(328),Q=n(145),X=n.n(Q),Y=n(146),Z=n.n(Y),$="asc",ee="desc",te=function(e){var t=e.setFilter,n=function(e){return function(){return t((function(t){return Object(U.a)(Object(U.a)({},t),{},{filterType:e})}))}},r=function(e){return function(){return t((function(t){return Object(U.a)(Object(U.a)({},t),{},{sortDirection:e})}))}};return Object(p.jsx)(F.a,{mt:2,children:Object(p.jsxs)(E.a,{container:!0,justifyContent:"space-between",alignItems:"center",children:[Object(p.jsxs)(F.a,{children:[Object(p.jsx)(j.a,{onClick:n(""),children:"All"}),Object(p.jsx)(j.a,{onClick:n("done"),children:"Done"}),Object(p.jsx)(j.a,{onClick:n("undone"),children:"Undone"})]}),Object(p.jsxs)(F.a,{children:[Object(p.jsx)(d.a,{display:"inline",children:"Sort by Date"}),Object(p.jsx)(G.a,{onClick:r(ee),children:Object(p.jsx)(X.a,{})}),Object(p.jsx)(G.a,{onClick:r($),children:Object(p.jsx)(Z.a,{})})]})]})})},ne=n(329),re=n(147),ae=n.n(re),ce=n(148),ie=n.n(ce),oe=Object(s.a)((function(e){return{listItem:{borderRadius:"5px",border:"1px solid"+e.palette.grey[400],marginTop:e.spacing(1),transition:"all .4s"},completed:{background:"#eaffe9",borderColor:e.palette.success.main},hiddenInput:{width:"100px"}}})),se=function(e){var t=e.task,n=e.editTaskFetch,a=e.deleteTaskFetch,c=(e.changePosition,e.dragAndDrop),i=oe(),o=Object(r.useState)(!0),s=Object(h.a)(o,2),u=s[0],l=s[1],j=function(){var e=Object(x.a)(O.a.mark((function e(n){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.stopPropagation(),a(t.id);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(p.jsx)(ne.a,{className:t.done?[i.listItem,i.completed].join(" "):i.listItem,onClick:function(e){e.stopPropagation(),l(!1)},onDragStart:c.dragStartHandler,onDragLeave:c.dragLeaveHandler,onDragOver:c.dragOverHandler,onDragEnd:c.dragEndHandler,onDrop:c.onDropHandler,draggable:!0,children:Object(p.jsxs)(E.a,{container:!0,justifyContent:"space-between",alignItems:"center",children:[Object(p.jsxs)(F.a,{children:[Object(p.jsx)(G.a,{size:"small",onClick:function(e){e.stopPropagation(),n(t.id,{done:!0})},className:"icon-button",children:Object(p.jsx)(ae.a,{})}),u?Object(p.jsx)(d.a,{component:"span",children:t.name}):Object(p.jsx)(M.a,{autoFocus:!0,onBlur:function(){return l(!0)},onKeyDown:function(e){"Enter"===e.code&&(n(t.id,{name:e.target.value}),l(!0)),"Escape"===e.code&&l(!0)},defaultValue:t.name})]}),Object(p.jsxs)(F.a,{children:[Object(p.jsx)(d.a,{component:"span",children:t.createdAt.substr(0,10)}),Object(p.jsx)(G.a,{size:"small",onClick:j,className:"icon-button",children:Object(p.jsx)(ie.a,{})})]})]})})},ue=n(327),le=function(e){var t=e.displayedTasks,n=e.editTaskFetch,a=e.deleteTaskFetch,c=e.changePosition,i=e.tasks,o=(e.filter,Object(r.useState)({})),s=Object(h.a)(o,2),u=s[0],l=s[1],d=function(e){return{dragStartHandler:function(t){l(e)},dragLeaveHandler:function(e){e.target.style.transform=""},dragOverHandler:function(e){e.preventDefault(),e.target.style.transform="scale(1.03)"},onDropHandler:function(t){t.preventDefault();var r=i.reduce((function(t,n){return u.menu_position>e.menu_position?n.menu_position>e.menu_position&&n.menu_position<t?n.menu_position:t:n.menu_position<e.menu_position&&n.menu_position>t?n.menu_position:t}),u.menu_position),a=e.menu_position-Math.ceil((r-e.menu_position)/2);n(u.id,{menu_position:a})}}};return Object(p.jsx)(ue.a,{children:t.length>0&&t.map((function(e){return Object(p.jsx)(se,{task:e,editTaskFetch:n,deleteTaskFetch:a,changePosition:c,dragAndDrop:d(e)},e.id)}))})},de=n(332),je=function(){function e(){Object(I.a)(this,e)}return Object(R.a)(e,null,[{key:"getAll",value:function(){var e=Object(x.a)(O.a.mark((function e(){var t,n,r,a,c=arguments;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:"",n=c.length>1&&void 0!==c[1]?c[1]:$,r={order:n},t&&(r.filterBy=t),e.next=6,y.get("/tasks",{params:r});case 6:if(200===(a=e.sent).status){e.next=9;break}throw Error("Failed to get the task list");case 9:return e.abrupt("return",a.data);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"create",value:function(){var e=Object(x.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.post("/task",{name:t,done:!1});case 2:if(200===(n=e.sent).status){e.next=5;break}throw Error("Task not created");case 5:return e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"edit",value:function(){var e=Object(x.a)(O.a.mark((function e(t,n){var r;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.patch("/task/".concat(t),n);case 2:if(200===(r=e.sent).status){e.next=5;break}throw Error("Data change error");case 5:return e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(x.a)(O.a.mark((function e(t){var n;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.delete("/task/".concat(t));case 2:if(204===(n=e.sent).status){e.next=5;break}throw Error("Data deletion error");case 5:return e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),pe=function(){var e=Object(r.useState)(""),t=Object(h.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)([]),i=Object(h.a)(c,2),o=i[0],s=i[1],u=Object(r.useState)({sortDirection:ee,filterType:""}),l=Object(h.a)(u,2),j=l[0],b=l[1],f=Object(r.useState)({page:1,limit:5}),m=Object(h.a)(f,2),g=m[0],v=m[1],w=Object(r.useMemo)((function(){return A(Object(x.a)(O.a.mark((function e(){var t;return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,je.getAll(j.filterType,j.sortDirection);case 2:t=e.sent,s(t);case 4:case"end":return e.stop()}}),e)}))),a)}),[j]),k=A(function(){var e=Object(x.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,je.create(t);case 2:v((function(e){return Object(U.a)(Object(U.a)({},e),{},{page:1})})),b({sortDirection:ee,filterType:""});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a),T=A(function(){var e=Object(x.a)(O.a.mark((function e(t,n){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,je.edit(t,n);case 2:w();case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),a),y=A(function(){var e=Object(x.a)(O.a.mark((function e(t){return O.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,je.delete(t);case 2:w();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a);Object(r.useEffect)((function(){w()}),[w]),Object(r.useEffect)((function(){v((function(e){return Object(U.a)(Object(U.a)({},e),{},{page:1})}))}),[j]);var S=Object(r.useMemo)((function(){return o.slice((g.page-1)*g.limit,(g.page-1)*g.limit+g.limit)}),[o,g]);return Object(p.jsx)(E.a,{container:!0,alignItems:"center",justifyContent:"center",className:"gridContainer",style:{height:"100vh"},children:Object(p.jsx)(D.a,{maxWidth:"sm",children:Object(p.jsxs)(E.a,{container:!0,direction:"column",children:[n&&Object(p.jsx)(q,{time:2e3,setError:a,children:n}),Object(p.jsx)(d.a,{variant:"h4",component:"h1",align:"center",children:"ToDo"}),Object(p.jsx)(J,{setTasks:s,createTaskFetch:k}),Object(p.jsx)(te,{setFilter:b}),Object(p.jsx)(le,{displayedTasks:S,deleteTaskFetch:y,editTaskFetch:T,tasks:o,filter:j}),Object(p.jsx)(de.a,{count:Math.ceil(o.length/g.limit),onChange:function(e,t){return v((function(e){return Object(U.a)(Object(U.a)({},e),{},{page:t})}))},page:g.page,className:"todo-pagination"})]})})})},be=Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(o.b,{path:"/login",children:Object(p.jsx)(W,{login:S})}),Object(p.jsx)(o.b,{path:"/registration",children:Object(p.jsx)(K,{login:S})}),Object(p.jsx)(o.a,{to:"/login"})]}),fe=Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)(o.b,{path:"/",children:Object(p.jsx)(pe,{})}),Object(p.jsx)(o.a,{to:"/"})]});var he=function(){var e=T();return Object(p.jsxs)(i.a,{children:[Object(p.jsx)(f,{logged:e,logout:C}),Object(p.jsx)(o.d,{children:e?fe:be})]})};c.a.render(Object(p.jsx)(he,{}),document.getElementById("root"))}},[[288,1,2]]]);
//# sourceMappingURL=main.f79a34d4.chunk.js.map