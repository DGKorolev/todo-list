(this["webpackJsonptodo-react-app"]=this["webpackJsonptodo-react-app"]||[]).push([[0],{164:function(e,t,n){},288:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(14),c=n.n(a),o=(n(164),n(35)),i=n(16),s=n(317),u=n(319),l=n(321),d=n(322),p=n(323),j=n(2),b=Object(s.a)((function(e){return{root:{flexGrow:1},menuButton:{marginRight:e.spacing(2)},title:{flexGrow:1}}})),f=function(e){var t=e.logged,n=e.logout,r=b();return Object(j.jsx)(u.a,{position:"fixed",children:Object(j.jsxs)(l.a,{children:[Object(j.jsx)("div",{className:r.title,children:t&&Object(j.jsx)(o.b,{to:"/",children:Object(j.jsx)(d.a,{variant:"h6",children:"Tasks"})})}),Object(j.jsx)("div",{children:t?Object(j.jsx)(p.a,{color:"inherit",onClick:n,children:"Logout"}):Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(o.b,{to:"/login",children:Object(j.jsx)(p.a,{color:"inherit",children:"Login"})}),Object(j.jsx)(o.b,{to:"/registration",children:Object(j.jsx)(p.a,{color:"inherit",children:"Registration"})})]})})]})})},h=n(15),m=n(7),x=n.n(m),O=n(13),g=n(83),v=n.n(g),k=v.a.create({withCredentials:!0,baseURL:"https://todo-backend-alpaca.herokuapp.com/"}),w=function(){var e=function(){var e=[],t="jwtToken",n=function(e){return e&&1e3*JSON.parse(atob(e.split(".")[1])).exp||null},r=function(){var e=Object(O.a)(x.a.mark((function e(){var t,r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=localStorage.getItem("jwtToken"),!((a=n(t))&&Date.now()>a)){e.next=6;break}return e.next=4,k.post("/refresh-token");case 4:r=e.sent,c(r.data.jwtToken);case 6:return e.abrupt("return",localStorage.getItem("jwtToken"));case 7:case"end":return e.stop()}var a}),e)})));return function(){return e.apply(this,arguments)}}(),a=function(){return!!localStorage.getItem("jwtToken")},c=function(e){e?localStorage.setItem(t,e):localStorage.removeItem(t),o()},o=function(){var t=a();e.forEach((function(e){return e(t)}))};return{getToken:r,isLoggedIn:a,setToken:c,subscribe:function(t){e.push(t)},unsubscribe:function(t){e=e.filter((function(e){return e!==t}))}}}(),t=v.a.create({baseURL:"https://todo-backend-alpaca.herokuapp.com/"});t.interceptors.request.use(function(){var t=Object(O.a)(x.a.mark((function t(n){return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.t0="Bearer ",t.next=3,e.getToken();case 3:return t.t1=t.sent,n.headers.Authorization=t.t0.concat.call(t.t0,t.t1),t.abrupt("return",n);case 6:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}());return{useAuth:function(){var t=Object(r.useState)(e.isLoggedIn()),n=Object(h.a)(t,2),a=n[0],c=n[1],o=Object(r.useCallback)((function(e){c(e)}),[c]);return Object(r.useEffect)((function(){return e.subscribe(o),function(){e.unsubscribe(o)}}),[o]),a},axiosWithToken:t,login:function(t){e.setToken(t)},logout:function(){var t=Object(O.a)(x.a.mark((function t(){return x.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,k.post("/logout");case 2:e.setToken(null);case 3:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}()}}(),y=w.useAuth,T=w.axiosWithToken,C=w.login,S=w.logout,F=n(149),D=n(324),E=n(325),P=n(330),I=n(331),B=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return Object(O.a)(x.a.mark((function n(){var r=arguments;return x.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.apply(void 0,r);case 3:return n.abrupt("return",n.sent);case 6:n.prev=6,n.t0=n.catch(0),t&&t(n.t0.message),console.log(n.t0.message);case 10:case"end":return n.stop()}}),n,null,[[0,6]])})))},_=n(10),L=n(11),N=function(){function e(){Object(_.a)(this,e)}return Object(L.a)(e,null,[{key:"registration",value:function(){var e=Object(O.a)(x.a.mark((function e(t){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.post("/registration",t);case 2:if(200===(n=e.sent).status){e.next=5;break}throw Error("Failed to get the task list");case 5:return e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"login",value:function(){var e=Object(O.a)(x.a.mark((function e(t){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k.post("/login",t);case 2:if(200===(n=e.sent).status){e.next=5;break}throw Error("Failed to get the task list");case 5:return e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),A=n(32),H=n(87),R=["login"],q=function(e){var t=e.login,n=(Object(F.a)(e,R),Object(r.useState)(!1)),a=Object(h.a)(n,2),c=a[0],o=a[1],s=A.a().shape({email:A.c().required().email(),password:A.c().required()}),u=B(function(){var e=Object(O.a)(x.a.mark((function e(n){var r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.login(n);case 2:if((r=e.sent).jwtToken){e.next=5;break}return e.abrupt("return");case 5:o(!0),t(r.jwtToken);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());return c?Object(j.jsx)(i.a,{to:"/"}):Object(j.jsx)(D.a,{container:!0,alignItems:"center",justifyContent:"center",style:{height:"100vh"},children:Object(j.jsx)(E.a,{maxWidth:"sm",children:Object(j.jsx)(H.a,{initialValues:{email:"",password:"",confirmPassword:""},onSubmit:function(e){u(e)},validationSchema:s,validateOnBlur:!0,children:function(e){var t=e.values,n=e.errors,r=e.touched,a=e.handleChange,c=e.handleBlur,o=e.isValid,i=e.handleSubmit,s=e.dirty,u=e.isSubmitting;return Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)("form",{children:[Object(j.jsxs)(D.a,{container:!0,direction:"column",className:"formContainer",children:[Object(j.jsx)(d.a,{variant:"h4",component:"h4",align:"center",children:"Login"}),Object(j.jsx)(P.a,{name:"email",label:"Login",type:"text",utocomplete:"username email",error:!(!r.email||!n.email),helperText:r.email&&n.email,onChange:a,onBlur:c,value:t.email}),Object(j.jsx)(P.a,{name:"password",label:"Password",type:"text",utocomplete:"password",error:!(!r.password||!n.password),helperText:r.password&&n.password,onChange:a,onBlur:c,value:t.password})]}),Object(j.jsx)(I.a,{mt:3,children:Object(j.jsx)(p.a,{disabled:!s||!o||u,variant:"contained",color:"primary",type:"submit",onClick:i,children:"Login"})})]})})}})})})},V=function(e){var t=e.login,n=Object(r.useState)(!1),a=Object(h.a)(n,2),c=a[0],o=a[1],s=A.a().shape({email:A.c().required().email(),password:A.c().required(),confirmPassword:A.c().required().oneOf([A.b("password")],"Password mismatch")}),u=B(function(){var e=Object(O.a)(x.a.mark((function e(n){var r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,N.registration(n);case 2:if((r=e.sent).jwtToken){e.next=5;break}return e.abrupt("return");case 5:o(!0),t(r.jwtToken);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());return c?Object(j.jsx)(i.a,{to:"/"}):Object(j.jsx)(D.a,{container:!0,alignItems:"center",justifyContent:"center",style:{height:"100vh"},children:Object(j.jsx)(E.a,{maxWidth:"sm",children:Object(j.jsx)(H.a,{initialValues:{email:"",password:"",confirmPassword:""},onSubmit:function(e){delete e.confirmPassword,u(e)},validationSchema:s,validateOnBlur:!0,children:function(e){var t=e.values,n=e.errors,r=e.touched,a=e.handleChange,c=e.handleBlur,o=e.isValid,i=e.handleSubmit,s=e.dirty,u=e.isSubmitting;return Object(j.jsx)(j.Fragment,{children:Object(j.jsxs)("form",{children:[Object(j.jsxs)(D.a,{container:!0,direction:"column",className:"formContainer",children:[Object(j.jsx)(d.a,{variant:"h4",component:"h4",align:"center",children:"Registration"}),Object(j.jsx)(P.a,{name:"email",label:"Login",type:"text",utocomplete:"username email",error:!(!r.email||!n.email),helperText:r.email&&n.email,onChange:a,onBlur:c,value:t.email}),Object(j.jsx)(P.a,{name:"password",label:"Password",type:"text",utocomplete:"password",error:!(!r.password||!n.password),helperText:r.password&&n.password,onChange:a,onBlur:c,value:t.password}),Object(j.jsx)(P.a,{name:"confirmPassword",label:"Confirm password",type:"text",utocomplete:"password",error:!(!r.confirmPassword||!n.confirmPassword),helperText:r.confirmPassword&&n.confirmPassword,onChange:a,onBlur:c,value:t.confirmPassword})]}),Object(j.jsx)(I.a,{mt:3,children:Object(j.jsx)(p.a,{disabled:!s||!o||u,variant:"contained",color:"primary",type:"submit",onClick:i,children:"Registration"})})]})})}})})})},W=n(30),M=Object(s.a)((function(e){return{error:{display:"block",textAlign:"center",background:e.palette.error.light,borderRadius:"5px",padding:"8px 24px"}}})),z=function(e){var t=e.children,n=e.setError,a=e.time,c=M();return Object(r.useEffect)((function(){setTimeout((function(){n("")}),a)})),Object(j.jsx)(I.a,{p:1,children:Object(j.jsx)(d.a,{component:"span",className:c.error,children:t})})},J=n(326),U=Object(s.a)((function(e){return{inputForm:{padding:[e.spacing(1),e.spacing(1)].join(" "),marginTop:e.spacing(2),width:"100%"}}})),G=function(e){var t=e.createTaskFetch,n=U(),a=Object(r.useState)(""),c=Object(h.a)(a,2),o=c[0],i=c[1],s=function(){var e=Object(O.a)(x.a.mark((function e(n){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("Enter"!==n.code||!o.trim()){e.next=4;break}return e.next=3,t(o);case 3:i("");case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(j.jsx)(j.Fragment,{children:Object(j.jsx)(J.a,{className:n.inputForm,type:"text",placeholder:"i want to ...",value:o,onChange:function(e){i(e.target.value)},onKeyDown:s})})},K=n(328),Q=n(145),X=n.n(Q),Y=n(146),Z=n.n(Y),$="asc",ee="desc",te=function(e){var t=e.setFilter,n=function(e){return function(){return t((function(t){return Object(W.a)(Object(W.a)({},t),{},{filterType:e})}))}},r=function(e){return function(){return t((function(t){return Object(W.a)(Object(W.a)({},t),{},{sortDirection:e})}))}};return Object(j.jsx)(I.a,{mt:2,children:Object(j.jsxs)(D.a,{container:!0,justifyContent:"space-between",alignItems:"center",children:[Object(j.jsxs)(I.a,{children:[Object(j.jsx)(p.a,{onClick:n(""),children:"All"}),Object(j.jsx)(p.a,{onClick:n("done"),children:"Done"}),Object(j.jsx)(p.a,{onClick:n("undone"),children:"Undone"})]}),Object(j.jsxs)(I.a,{children:[Object(j.jsx)(d.a,{display:"inline",children:"Sort by Date"}),Object(j.jsx)(K.a,{onClick:r(ee),children:Object(j.jsx)(X.a,{})}),Object(j.jsx)(K.a,{onClick:r($),children:Object(j.jsx)(Z.a,{})})]})]})})},ne=n(329),re=n(147),ae=n.n(re),ce=n(148),oe=n.n(ce),ie=Object(s.a)((function(e){return{listItem:{borderRadius:"5px",border:"1px solid"+e.palette.grey[400],marginTop:e.spacing(1),transition:"all .4s"},completed:{background:"#eaffe9",borderColor:e.palette.success.main},hiddenInput:{width:"100px"}}})),se=function(e){var t=e.task,n=e.editTaskFetch,a=e.deleteTaskFetch,c=(e.changePosition,e.dragAndDrop),o=ie(),i=Object(r.useState)(!0),s=Object(h.a)(i,2),u=s[0],l=s[1],p=function(){var e=Object(O.a)(x.a.mark((function e(n){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.stopPropagation(),a(t.id);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(j.jsx)(ne.a,{className:t.done?[o.listItem,o.completed].join(" "):o.listItem,onClick:function(e){e.stopPropagation(),l(!1)},onDragStart:c.dragStartHandler,onDragLeave:c.dragLeaveHandler,onDragOver:c.dragOverHandler,onDragEnd:c.dragEndHandler,onDrop:c.onDropHandler,draggable:!0,children:Object(j.jsxs)(D.a,{container:!0,justifyContent:"space-between",alignItems:"center",children:[Object(j.jsxs)(I.a,{children:[Object(j.jsx)(K.a,{size:"small",onClick:function(e){e.stopPropagation(),n(t.id,{done:!0})},className:"icon-button",children:Object(j.jsx)(ae.a,{})}),u?Object(j.jsx)(d.a,{component:"span",children:t.name}):Object(j.jsx)(J.a,{autoFocus:!0,onBlur:function(){return l(!0)},onKeyDown:function(e){"Enter"===e.code&&(n(t.id,{name:e.target.value}),l(!0)),"Escape"===e.code&&l(!0)},defaultValue:t.name})]}),Object(j.jsxs)(I.a,{children:[Object(j.jsx)(d.a,{component:"span",children:t.createdAt.substr(0,10)}),Object(j.jsx)(K.a,{size:"small",onClick:p,className:"icon-button",children:Object(j.jsx)(oe.a,{})})]})]})})},ue=n(327),le=function(e){var t=e.displayedTasks,n=e.editTaskFetch,a=e.deleteTaskFetch,c=e.changePosition,o=e.tasks,i=(e.filter,Object(r.useState)({})),s=Object(h.a)(i,2),u=s[0],l=s[1],d=function(e){return{dragStartHandler:function(t){l(e)},dragLeaveHandler:function(e){e.target.style.transform=""},dragOverHandler:function(e){e.preventDefault(),e.target.style.transform="scale(1.03)"},onDropHandler:function(t){t.preventDefault();var r=o.reduce((function(t,n){return u.menu_position>e.menu_position?n.menu_position>e.menu_position&&n.menu_position<t?n.menu_position:t:n.menu_position<e.menu_position&&n.menu_position>t?n.menu_position:t}),u.menu_position),a=e.menu_position-Math.ceil((r-e.menu_position)/2);n(u.id,{menu_position:a})}}};return Object(j.jsx)(ue.a,{children:t.length>0&&t.map((function(e){return Object(j.jsx)(se,{task:e,editTaskFetch:n,deleteTaskFetch:a,changePosition:c,dragAndDrop:d(e)},e.id)}))})},de=n(332),pe=function(){function e(){Object(_.a)(this,e)}return Object(L.a)(e,null,[{key:"getAll",value:function(){var e=Object(O.a)(x.a.mark((function e(){var t,n,r,a,c=arguments;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>0&&void 0!==c[0]?c[0]:"",n=c.length>1&&void 0!==c[1]?c[1]:$,r={order:n},t&&(r.filterBy=t),e.next=6,T.get("/tasks",{params:r});case 6:if(200===(a=e.sent).status){e.next=9;break}throw Error("Failed to get the task list");case 9:return e.abrupt("return",a.data);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},{key:"create",value:function(){var e=Object(O.a)(x.a.mark((function e(t){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.post("/task",{name:t,done:!1});case 2:if(200===(n=e.sent).status){e.next=5;break}throw Error("Task not created");case 5:return e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},{key:"edit",value:function(){var e=Object(O.a)(x.a.mark((function e(t,n){var r;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.patch("/task/".concat(t),n);case 2:if(200===(r=e.sent).status){e.next=5;break}throw Error("Data change error");case 5:return e.abrupt("return",r.data);case 6:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"delete",value:function(){var e=Object(O.a)(x.a.mark((function e(t){var n;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,T.delete("/task/".concat(t));case 2:if(204===(n=e.sent).status){e.next=5;break}throw Error("Data deletion error");case 5:return e.abrupt("return",n.data);case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}]),e}(),je=function(){var e=Object(r.useState)(""),t=Object(h.a)(e,2),n=t[0],a=t[1],c=Object(r.useState)([]),o=Object(h.a)(c,2),i=o[0],s=o[1],u=Object(r.useState)({sortDirection:ee,filterType:""}),l=Object(h.a)(u,2),p=l[0],b=l[1],f=Object(r.useState)({page:1,limit:5}),m=Object(h.a)(f,2),g=m[0],v=m[1],k=Object(r.useMemo)((function(){return B(Object(O.a)(x.a.mark((function e(){var t;return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe.getAll(p.filterType,p.sortDirection);case 2:t=e.sent,s(t);case 4:case"end":return e.stop()}}),e)}))),a)}),[p]),w=B(function(){var e=Object(O.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe.create(t);case 2:v((function(e){return Object(W.a)(Object(W.a)({},e),{},{page:1})})),b({sortDirection:ee,filterType:""});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a),y=B(function(){var e=Object(O.a)(x.a.mark((function e(t,n){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe.edit(t,n);case 2:k();case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),a),T=B(function(){var e=Object(O.a)(x.a.mark((function e(t){return x.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,pe.delete(t);case 2:k();case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),a);Object(r.useEffect)((function(){k()}),[k]),Object(r.useEffect)((function(){v((function(e){return Object(W.a)(Object(W.a)({},e),{},{page:1})}))}),[p]);var C=Object(r.useMemo)((function(){return i.slice((g.page-1)*g.limit,(g.page-1)*g.limit+g.limit)}),[i,g]);return Object(j.jsx)(D.a,{container:!0,alignItems:"center",justifyContent:"center",className:"gridContainer",style:{height:"100vh"},children:Object(j.jsx)(E.a,{maxWidth:"sm",children:Object(j.jsxs)(D.a,{container:!0,direction:"column",children:[n&&Object(j.jsx)(z,{time:2e3,setError:a,children:n}),Object(j.jsx)(d.a,{variant:"h4",component:"h1",align:"center",children:"ToDo"}),Object(j.jsx)(G,{setTasks:s,createTaskFetch:w}),Object(j.jsx)(te,{setFilter:b}),Object(j.jsx)(le,{displayedTasks:C,deleteTaskFetch:T,editTaskFetch:y,tasks:i,filter:p}),Object(j.jsx)(de.a,{count:Math.ceil(i.length/g.limit),onChange:function(e,t){return v((function(e){return Object(W.a)(Object(W.a)({},e),{},{page:t})}))},page:g.page,className:"todo-pagination"})]})})})},be=Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(i.b,{path:"/login",children:Object(j.jsx)(q,{login:C})}),Object(j.jsx)(i.b,{path:"/registration",children:Object(j.jsx)(V,{login:C})}),Object(j.jsx)(i.a,{to:"/login"})]}),fe=Object(j.jsxs)(j.Fragment,{children:[Object(j.jsx)(i.b,{path:"/",children:Object(j.jsx)(je,{})}),Object(j.jsx)(i.a,{to:"/"})]});var he=function(){var e=y();return Object(j.jsxs)(o.a,{children:[Object(j.jsx)(f,{logged:e,logout:S}),Object(j.jsx)(i.d,{children:e?fe:be})]})};c.a.render(Object(j.jsx)(he,{}),document.getElementById("root"))}},[[288,1,2]]]);
//# sourceMappingURL=main.70ab6eb8.chunk.js.map